# stock-aggregator
auカブコム証券のKabuステーションAPIを利用して受信したティック情報を集計する。

## 設定
### プロパティファイル
以下項目を記載したconfig.iniをディレクトリ直下に置く。

| Section | Key | Type | Value（Description） |
| --- | --- | --- | --- |
| DEFAULT | tickdata_directory | str | ティック情報を出力するディレクトリパスを設定する。 |
| DEFAULT | target_filename | str | 集計対象銘柄リストのCSVファイル名を設定する。 |
| DEFAULT | output_directory | str | CSVの出力先ディレクトリ名を設定する。 |

``` ini
[Section]
Key = Value
.
.
.
```
## 起動
``` shell
python -m stock-aggregator --output console --day <YYYYMM[DD]> --close <10-15>
```
### オプション
| オプション名 | デフォルト | 内容 |
| --- | --- | --- |
| --output | console | 起動モードを指定する。<br> - console: コンソール出力 <br> - csv: CSV出力（出力先の設定が必須） |
| --day | None | 集計対象の日付を「YYYYMMDD」形式、または年月を「YYYYMM」形式で指定する。<br>全データを対象とする場合は指定しない。 |
| --close | 15 | 集計の終了時間を指定する。 |
| --buy | 1 | 集計の開始価格の買大約定数を指定する。 |
| --sell | 1 | 集計の終了価格の売大約定数を指定する。 |
| --offset-minute | 5 | 大注文集計開始時間を寄りから n 分前で指定する。 |

## 出力項目
| 項目名 | 説明 |
| --- | --- |
| 日付 | 開場日を出力する。 |
| 曜日 | 開場日の曜日を出力する。 |
| 銘柄コード | 銘柄コードを出力する。 |
| 銘柄名 | 銘柄名を出力する。 |
| 閾値 | 設定した売買代金閾値を出力する。 |
| 前日終値 | 前日の終値を出力する。 |
| 前日時価総額 | 前日終値での時価総額を出力する。 |
| 前場寄前注文時間 | 前場寄り付き前の大注文の時間を出力する。 |
| 前場寄前注文回数 | 前場寄り付き前の大注文の回数を出力する。 |
| 後場寄前注文時間 | 後場寄り付き前の大注文の時間を出力する。 |
| 後場寄前注文回数 | 後場寄り付き前の大注文の回数を出力する。 |
| 寄付時間 | 寄り付き時間を出力する。 |
| 寄付価格 | 寄り付き価格（始値）を出力する。 |
| 寄時売買代金 | 寄り付きの売買代金を出力する。 |
| 買前売約定時間 | 買いの大約定前の売りの大約定の時間を出力する。 |
| 買前売約定価格 | 買いの大約定前の売りの大約定の価格を出力する。 |
| 買前売約定回数 | 買いの大約定前の売りの大約定の回数を出力する。 |
| 買約定時間 | 買いの大約定の時間を出力する。 |
| 買約定価格 | 買いの大約定の価格を出力する。 |
| 買約定直前価格 | 買いの大約定の直前の価格を出力する。 |
| 買約定回数 | 買いの大約定の回数を出力する。 |
| 買時売買代金一分 | 買いの大約定があったときの直近一分間の売買代金を出力する。 |
| 買時板更新数一分 | 買いの大約定があったときの直近一分間の板更新数を出力する。 |
| 買時売買代金 | 買いの大約定があったときの総売買代金を出力する。 |
| 買時VWAP | 買いの大約定があったときのVWAPを出力する。 |
| 買時状態 | 買いの大約定があったときの状態を出力する。<br> - preparing: 前場寄り前<br> - nowopened: 前場寄り時<br> - reopened: 後場寄り時<br> - resumed: 連特寄り時<br> - resting: 休憩（前場後場間）<br> - freezing: 連続・特別気配時<br> - closing: 後場引け時<br> - opening: ザラ場通常時 |
| 安値時間 | 買いの大約定から売りの大約定の間の安値の時間を出力する。 |
| 安値 | 買いの大約定から売りの大約定の間の安値を出力する。 |
| 高値時間 | 買いの大約定から売りの大約定の間の高値の時間を出力する。 |
| 高値 | 買いの大約定から売りの大約定の間の高値を出力する。 |
| 売約定時間 | 買いの大約定の後の売りの大約定の時間を出力する。 |
| 売約定価格 | 買いの大約定の後の売りの大約定の価格を出力する。 |
| 売約定直前価格 | 買いの大約定の後の売りの大約定の直前の価格を出力する。 |
| 売約定回数 | 買いの大約定の後の売りの大約定の回数を出力する。 |
| 売時売買代金一分 | 売りの大約定があったときの直近一分間の売買代金を出力する。 |
| 売時板更新数一分 | 売りの大約定があったときの直近一分間の板更新数を出力する。 |
| 期間内売買代金 | 買いの大約定から売りの大約定の間の売買代金を出力する。 |
| 買時VWAP | 売りの大約定があったときのVWAPを出力する。 |
| 売時状態 | 売りの大約定があったときの状態を出力する。<br> ※買いの種類と同じ |
| 売後買約定回数 | 売りの大約定の後の買いの大約定の回数を出力する。 |
| 当日安値時間 | 当日の安値の時間を出力する。 |
| 当日安値 | 当日の安値を出力する。 |
| 当日高値時間 | 当日の高値の時間を出力する。 |
| 当日高値 | 当日の高値を出力する。 |
| 終了時間 | 場が終了した時間を出力する。<br> ※14:59:50が最終 |
| 終了価格 | 場が終了した価格を出力する。 |
| 当日売買代金 | 当日の総売買代金を出力する。 |

